using System.Text.Json.Serialization;
using System.Collections.Generic;
using Tartarus.Model.Root;
using System;
using Newtonsoft.Json;

namespace Tartarus.Model.Vulnerability
{
    public class VulnerabilityData
    {
        [JsonProperty("type")]
        public string Type { get; set; }
        [JsonProperty("attributes")]
        public Vulnerability Attributes { get; set; }
    }

    public class Vulnerabilities
    {
        public List<Vulnerability> vulnerabilityList { get; set; }
    }

    public class Vulnerability
    {
        [JsonPropertyName("VID")]
        public int VID { get; set; }

        [JsonPropertyName("AssetName")]
        public string AssetName { get; set; }

        [JsonPropertyName("AssetType")]
        public string AssetType { get; set; }

        [JsonPropertyName("CompanyShortName")]
        public string CompanyShortName { get; set; }

        [JsonPropertyName("Source")]
        public string Source { get; set; }

        [JsonPropertyName("SourceId")]
        public string SourceId { get; set; }

        [JsonPropertyName("OS")]
        public string OS { get; set; }

        [JsonPropertyName("VendorName")]
        public string VendorName { get; set; }

        [JsonPropertyName("VenderReference")]
        public string VendorReference { get; set; }

        [JsonPropertyName("ProductName")]
        public string ProductName { get; set; }

        [JsonPropertyName("ProductVersion")]
        public string ProductVersion { get; set; }

        [JsonPropertyName("CVEID")]
        public string CVEID { get; set; }

        [JsonPropertyName("IPAddress")]
        public string IPAddress { get; set; }

        [JsonPropertyName("FQDN")]
        public string FQDN { get; set; }

        [JsonPropertyName("Severity")]
        public string Severity { get; set; }

    }
    #region Machine Date Model
    public class JsonResponseDataMachine
    {
        public Machine[]? Value { get; set; }
    }
    public class Machine
    {
        public string Id { get; set; }
        public string ComputerDnsName { get; set; }
        public string FirstSeen { get; set; }
        public string LastSeen { get; set; }
        public string OsPlatform { get; set; }
        public string LastIpAddress { get; set; }
        public string LastExternalIpAddress { get; set; }
        public int OsBuild { get; set; }
        public string HealthStatus { get; set; }
        public int RbacGroupId { get; set; }
        public string RbacGroupName { get; set; }
        public string RiskScore { get; set; }
        public string ExposureLevel { get; set; }
        public bool IsAadJoined { get; set; }
        public string AadDeviceId { get; set; }
        public string[] MachineTags { get; set; }
    }
    #endregion
}